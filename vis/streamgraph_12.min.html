<!DOCTYPE html><meta charset="utf-8"><style>body{font:10px sans-serif}.chart{background:#fff}p{font:12px helvetica}.axis line,.axis path{fill:none;stroke:#000;stroke-width:2px;shape-rendering:crispEdges}button{position:absolute;right:50px;top:10px}</style><body><script src="d3.v3.min.js"></script><div id="datasets"></div><div class="chart"></div><script>function chart(t){var e=[],s=["#B30000","#E34A33","#FC8D59","#FDBB84"];strokecolor="#B30000";var o=d3.time.format("%m/%d/%Y %H:%M:%S"),a={top:20,right:40,bottom:30,left:30},r=document.body.clientWidth-a.left-a.right,n=600-a.top-a.bottom,l=d3.select("body").append("div").attr("class","remove").style("position","absolute").style("z-index","20").style("visibility","hidden").style("top","30px").style("left","55px"),i=d3.time.scale().range([0,r]),u=d3.scale.linear().range([n-10,0]),d=d3.scale.ordinal().range(s),c=d3.svg.axis().scale(i).orient("bottom").ticks(d3.time.days),m=(d3.svg.axis().scale(u),d3.svg.axis().scale(u),d3.layout.stack().offset("silhouette").values(function(t){return t.values}).x(function(t){return t.date}).y(function(t){return t.value})),y=d3.nest().key(function(t){return t.key}),p=d3.svg.area().interpolate("cardinal").x(function(t){return i(t.date)}).y0(function(t){return u(t.y0)}).y1(function(t){return u(t.y0+t.y)}),f=d3.select(".chart").append("svg").attr("width",r+a.left+a.right).attr("height",n+a.top+a.bottom).append("g").attr("transform","translate("+a.left+","+a.top+")");d3.tsv(t,function(t){t.forEach(function(t){t.date=o.parse(t.date),t.value=+t.value});var s=m(y.entries(t));i.domain(d3.extent(t,function(t){return t.date})),u.domain([0,d3.max(t,function(t){return t.y0+t.y})]),f.selectAll(".layer").data(s).enter().append("path").attr("class","layer").attr("d",function(t){return p(t.values)}).style("fill",function(t,e){return d(e)}),f.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")").call(c),f.selectAll(".layer").attr("opacity",1).on("mouseover",function(t,e){f.selectAll(".layer").transition().duration(250).attr("opacity",function(t,s){return s!=e?.6:1})}).on("mousemove",function(t,s){mousex=d3.mouse(this),mousex=mousex[0];var o=i.invert(mousex);o=o.getMonth()+o.getDate();for(var a=t.values,r=0;r<a.length;r++)e[r]=a[r].date,e[r]=e[r].getMonth()+e[r].getDate();mousedate=e.indexOf(o),pro=t.values[mousedate].value,d3.select(this).classed("hover",!0).attr("stroke",strokecolor).attr("stroke-width","0.5px"),l.html("<p>"+t.key+"<br>"+pro+"</p>").style("visibility","visible")}).on("mouseout",function(t,e){f.selectAll(".layer").transition().duration(250).attr("opacity","1"),d3.select(this).classed("hover",!1).attr("stroke-width","0px"),l.html("<p>"+t.key+"<br>"+pro+"</p>").style("visibility","hidden")});var a=d3.select(".chart").append("div").attr("class","remove").style("position","absolute").style("z-index","19").style("width","1px").style("height","380px").style("top","10px").style("bottom","30px").style("left","0px").style("background","#fff");d3.select(".chart").on("mousemove",function(){mousex=d3.mouse(this),mousex=mousex[0]+5,a.style("left",mousex+"px")}).on("mouseover",function(){mousex=d3.mouse(this),mousex=mousex[0]+5,a.style("left",mousex+"px")})})}chart("../data/sensor_stream_12.tsv")</script></body>